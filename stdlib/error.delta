func fatalError() {
    printStackTrace();
    abort();
}

func printStackTrace() {
    var callstack: mutable void*[128] = undefined;

    let frames = backtrace(&callstack[0], callstack.size());
    let strings = backtrace_symbols(&callstack[0], frames);

    for (let i in 0..frames) {
        printf("%s\n", *strings.offset(int64(i)));
    }

    free(cast<mutable void*>(strings));
}
